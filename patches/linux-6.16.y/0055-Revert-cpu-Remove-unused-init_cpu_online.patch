From 5a9a89bfad2c53d50fe87301c53e11c256db69ea Mon Sep 17 00:00:00 2001
From: Johnny Mnemonic <jm@machine-hall.org>
Date: Mon, 27 Jan 2025 15:44:13 +0100
Subject: [PATCH 55/73] Revert "cpu: Remove unused init_cpu_online"

This reverts commit 7f15d4abf925f33015fb62973ce2ddb45ce04bb9.
---
 include/linux/cpumask.h | 1 +
 kernel/cpu.c            | 5 +++++
 2 files changed, 6 insertions(+)

diff --git a/include/linux/cpumask.h b/include/linux/cpumask.h
index 7ae80a7ca81e..9487d09c7bf3 100644
--- a/include/linux/cpumask.h
+++ b/include/linux/cpumask.h
@@ -1121,6 +1121,7 @@ extern const DECLARE_BITMAP(cpu_all_bits, NR_CPUS);
 /* Wrappers for arch boot code to manipulate normally-constant masks */
 void init_cpu_present(const struct cpumask *src);
 void init_cpu_possible(const struct cpumask *src);
+void init_cpu_online(const struct cpumask *src);
 
 #define assign_cpu(cpu, mask, val)	\
 	assign_bit(cpumask_check(cpu), cpumask_bits(mask), (val))
diff --git a/kernel/cpu.c b/kernel/cpu.c
index c93a61c5c489..5efa2aaea768 100644
--- a/kernel/cpu.c
+++ b/kernel/cpu.c
@@ -3123,6 +3123,11 @@ void init_cpu_possible(const struct cpumask *src)
 	cpumask_copy(&__cpu_possible_mask, src);
 }
 
+void init_cpu_online(const struct cpumask *src)
+{
+	cpumask_copy(&__cpu_online_mask, src);
+}
+
 void set_cpu_online(unsigned int cpu, bool online)
 {
 	/*
-- 
2.25.1

